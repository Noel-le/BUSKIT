// datetime
var day = new Date();	
var week = new Array('일','월','화','수','목','금','토');

// get current time
var hours = day.getHours(); 
var minutes = day.getMinutes();
var seconds = day.getSeconds(); 
var now_time = hours * 3600 + minutes * 60  + seconds;


//get elements
const get = (target) => {
    return document.querySelector(target);
};

const $info = get(".bus-info");

const createInfoElement = (number,time) => {
    const routeno = number
    const arrtime = time
    const $busInfo = document.createElement("div");
    $busInfo.classList.add("bus-item");
    $busInfo.innerHTML = `
      <div class = 'bus-number'>${routeno}번</div>
        <li>도착예정시간</li> 
        <li>${arrtime}</li> 
        `;   
    return $busInfo;
}

const $info2 = get(".popup");
const createPopup = (number,time) => {
    const $popupList = document.createElement("div");
    $popupList.classList.add("content_area");
    $popupList.innerHTML = `
    <li class = 'busNum'>${number}</li>
    <ul>
        <li class = 'arrTime'>도착예정시간</li> 
        <li class = 'arrTime'>${time}</li>
    </ul>
    `
return $popupList
}

const renderAllinfo = (number, time) => {
    $info.innerHTML = "";
    const InfoElement = createInfoElement(number,time);
    $info.appendChild(InfoElement); 
};


const renderpopup = (number, time) => {
    $info2.innerHTML += "";
    const popupElement = createPopup(number,time);
    $info2.appendChild(popupElement); 
};



//display popup
const $dimmed_layer = get('.dimmed-layer')
const $nodeBtn = get('.nodeBtn')
const $popup  = get('.popup')
const popup = (number, time) =>{
    $nodeBtn.addEventListener("click",()=>{
          $dimmed_layer.classList.add("display")
          $popup.classList.add("show")
          $dimmed_layer.addEventListener("click",()=>{
            $dimmed_layer.classList.remove("display")
            $popup.classList.remove("show")
          })
          for(let i = 0; i < number.length; i++){
            renderpopup(number[i],time[i])
          }
        })
}

// School to Gumi station
const sc_st = () => {
  // bus_number && time data list
  // weekday
  var t2 = ['6:57:00', '7:38:00', '7:45:00', '7:50:00', '7:55:00', '7:58:00', '8:10:00', '8:20:00', '8:21:00', '8:26:00', '8:33:00', '8:43:00', '8:50:00', '9:05:00', '9:15:00', '9:17:00', '9:23:00', '9:28:00', '9:42:00', '9:47:00', '10:02:00', '10:12:00', '10:18:00', '10:20:00', '10:28:00', '10:30:00', '10:31:00', '10:42:00', '10:57:00', '11:11:00', '11:13:00', '11:25:00', '11:45:00', '11:46:00', '11:48:00', '12:14:00', '12:33:00', '12:38:00', '13:10:00', '13:16:00', '13:20:00', '13:40:00', '13:54:00', '13:58:00', '14:00:00', '14:18:00', '14:28:00', '14:35:00', '14:43:00', '14:53:00', '15:23:00', '15:34:00', '15:40:00', '15:54:00', '15:58:00', '16:08:00', '16:10:00', '16:13:00', '16:14:00', '16:23:00', '16:33:00', '16:38:00', '16:48:00', '16:53:00', '16:56:00', '17:05:00', '17:20:00', '17:23:00', '17:35:00', '17:52:00', '17:58:00', '18:18:00', '18:34:00', '18:35:00', '18:40:00', '18:43:00', '18:58:00', '19:03:00', '19:12:00', '19:23:00', '19:43:00', '19:55:00', '20:00:00', '20:08:00', '20:28:00', '20:31:00', '20:35:00', '20:40:00', '20:55:00', '21:08:00', '21:11:00', '21:13:00', '21:24:00', '21:34:00', '21:40:00', '21:58:00', '22:01:00', '22:12:00', '23:25:00']
  var n2 =  ['192', '57', '195', '891-2', '193', '196', '5200', '195', '557', '57', '196', '57', '190', '57', '5200', '192', '191', '196', '900', '190', '190-3', '192', '900', '193', '51-1', '195', '196', '190-3', '190', '196', '190-3', '195', '192, 190-3', '191', '900', '190', '196', '900', '193, 195', '196', '190', '57', '57', '196', '192', '900', '557', '191, 195', '51-1', '900', '196', '190', '195', '190-3', '193', '196', '192', '191', '190-3', '57', '190', '900', '196', '57', '190-3', '190-3', '5200', '191, 900', '195', '190', '57', '196', '57', '195', '193', '5200', '900', '196', '191', '51-1', '196', '900', '192', '191', '57, 190', '190-3', '193-2, 195', '192', '195', '900', '57', '196', '190-3', '190-3', '193', '900', '191', '190', '192, 196']
  var time2 = [25020, 27480, 27900, 28200, 28500, 28680, 29400, 30000, 30060, 30360, 30780, 31380, 31800, 32700, 33300, 33420, 33780, 34080, 34920, 35220, 36120, 36720, 37080, 37200, 37680, 37800, 37860, 38520, 39420, 40260, 40380, 41100, 42300, 42360, 42480, 44040, 45180, 45480, 47400, 47760, 48000, 49200, 50040, 50280, 50400, 51480, 52080, 52500, 52980, 53580, 55380, 56040, 56400, 57240, 57480, 58080, 58200, 58380, 58440, 58980, 59580, 59880, 60480, 60780, 60960, 61500, 62400, 62580, 63300, 64320, 64680, 65880, 66840, 66900, 67200, 67380, 68280, 68580, 69120, 69780, 70980, 71700, 72000, 72480, 73680, 73860, 74100, 74400, 75300, 76080, 76260, 76380, 77040, 77640, 78000, 79080, 79260, 79920, 84300]
  
  // holiday
  var t4 = ['6:57:00', '7:38:00', '7:45:00', '7:55:00', '7:58:00', '8:10:00', '8:20:00', '8:21:00', '8:26:00', '8:32:00', '8:33:00', '8:42:00', '8:43:00', '9:05:00', '9:12:00', '9:15:00', '9:28:00', '9:42:00', '10:02:00', '10:18:00', '10:20:00', '10:28:00', '10:30:00', '10:31:00', '10:42:00', '10:54:00', '11:11:00', '11:13:00', '11:25:00', '11:43:00', '11:45:00', '11:48:00', '12:07:00', '12:33:00', '12:38:00', '13:10:00', '13:16:00', '13:17:00', '13:40:00', '13:54:00', '13:58:00', '14:18:00', '14:28:00', '14:35:00', '14:41:00', '14:43:00', '14:53:00', '15:23:00', '15:29:00', '15:40:00', '15:54:00', '15:58:00', '16:08:00', '16:14:00', '16:20:00', '16:23:00', '16:25:00', '16:38:00', '16:48:00', '16:53:00', '16:56:00', '17:05:00', '17:20:00', '17:23:00', '17:28:00', '17:35:00', '17:42:00', '17:47:00', '17:58:00', '18:18:00', '18:34:00', '18:35:00', '18:40:00', '18:43:00', '18:58:00', '19:03:00', '19:23:00', '19:43:00', '19:55:00', '20:13:00', '20:27:00', '20:28:00', '20:31:00', '20:35:00', '20:55:00', '21:08:00', '21:11:00', '21:13:00', '21:24:00', '21:34:00', '21:40:00', '21:58:00', '22:03:00', '22:07:00', '22:25:00', '23:25:00']
  var n4 = ['192', '57', '195', '193', '196', '5200', '195', '557', '57', '190', '196', '192', '57', '57', '191', '5200', '196', '190, 900', '190-3', '900', '193', '51-1', '195', '196', '190-3', '190', '196', '190-3', '195', '191', '192, 190-3', '900', '190', '196', '900', '193, 195', '196', '190', '57', '57', '192, 196', '900', '557', '195', '191', '51-1', '900', '196', '190', '195', '190-3', '193', '191, 196', '190-3', '190', '57', '192', '900', '196', '57', '190-3', '190-3', '5200', '900', '191', '195', '192', '190', '57', '196', '57', '195', '193', '5200', '191, 900', '196', '51-1', '196', '900', '191', '190', '57', '190-3', '193-2, 195', '195', '900', '57', '196', '190-3', '190-3', '193', '900', '191', '190', '196', '192']
  var time4 = [25020, 27480, 27900, 28500, 28680, 29400, 30000, 30060, 30360, 30720, 30780, 31320, 31380, 32700, 33120, 33300, 34080, 34920, 36120, 37080, 37200, 37680, 37800, 37860, 38520, 39240, 40260, 40380, 41100, 42180, 42300, 42480, 43620, 45180, 45480, 47400, 47760, 47820, 49200, 50040, 50280, 51480, 52080, 52500, 52860, 52980, 53580, 55380, 55740, 56400, 57240, 57480, 58080, 58440, 58800, 58980, 59100, 59880, 60480, 60780, 60960, 61500, 62400, 62580, 62880, 63300, 63720, 64020, 64680, 65880, 66840, 66900, 67200, 67380, 68280, 68580, 69780, 70980, 71700, 72780, 73620, 73680, 73860, 74100, 75300, 76080, 76260, 76380, 77040, 77640, 78000, 79080, 79380, 79620, 80700, 84300]
  
  
  // info display
  if ((week[day.getDay()] ==="토") || (week[day.getDay()] === "일")){
    var n = 0;
    for (var i = 0; i <= t4.length; i++){
      if ((time4[n] < now_time) && (now_time <= time4[n+1])){
          renderAllinfo(n4[n+1],t4[n+1])
          // popup(n4,t4)
        // n = n+1;
        if(n >= 95){ //96
          document.write('<p style="font-size: 30px; text-align: center;">운행종료<br></p>');
        }else{
            renderAllinfo(n4[n+1],t4[n+1])
        }
      }else{
        n = n+1;
      } 
    }
    popup(n4,t4)
  }else{
    var n = 0;
    for (var i = 0; i <= t2.length; i++){
      if ((time2[n] < now_time) && (now_time <= time2[n+1])){
        renderAllinfo(n2[n+1],t2[n+1])
        // popup(n2,t2)
        // n = n+1;
        if(n >= 98){ //99
          document.write('<p style="font-size: 30px; text-align: center;">운행종료<br></p>');
        }else{
            renderAllinfo(n2[n+1],t2[n+1])
        }
      }else{
        n = n+1;
      } 
    }    
  }popup(n2,t2)
}

const init = () => {
  window.addEventListener("DOMContentLoaded", () => {
      sc_st()
      // st_sc()
  });
};  
init();
